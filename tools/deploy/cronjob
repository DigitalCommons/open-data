#!/bin/bash

SCRIPT=${BASH_SOURCE[0]}
REPO_DIR=$(readlink -f ${SCRIPT%/*}/../..)
SEOD='bundle exec seod'

function process {
    local dir="${1:?directory argument required}"
    (
	cd $REPO_DIR/$dir &&
	    bundler install &&
	    $SEOD download &&
	    $SEOD convert &&
	    $SEOD generate &&
	    sudo -nE $SEOD deploy &&
	    sudo -nE $SEOD triplestore
    )
}

for dir in oxford newbridge mersey-green deep-adaptation dotcoop covid-mutual-aid; do
    echo "PROCESSING $dir..."
    process "$dir"
    echo
done

